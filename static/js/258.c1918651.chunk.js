"use strict";(self.webpackChunktool_app=self.webpackChunktool_app||[]).push([[258],{8258:(e,t,s)=>{s.r(t),s.d(t,{default:()=>y});var o=s(5043),i=s(7835),a=s(2450),n=s(1828),r=s(4511),l=s(148),c=s(7392),d=s(7529),h=s(6727),p=s(3485),u=s(3987),x=s(3850),g=s(2499),j=s(4730),w=s(9984),v=s(5550),m=s(7141),k=s(579);const y=()=>{const[e,t]=(0,o.useState)("pen"),[s,y]=(0,o.useState)([]),[f,A]=(0,o.useState)(!1),[b,C]=(0,o.useState)("#000000"),[N,S]=(0,o.useState)(5),[W,M]=(0,o.useState)(1),F=(0,o.useRef)(null),[P,I]=(0,o.useState)([]),[B,D]=(0,o.useState)([]),[H,R]=(0,o.useState)(null),T=t=>{A(!0);const o=t.target.getStage().getPointerPosition(),i={tool:e,strokeColor:b,strokeWidth:N,opacity:W,points:[o.x,o.y]};y([...s,i])},U=t=>{if(!f)return;const o=t.target.getStage().getPointerPosition();let i=s[s.length-1];if("pen"===e||"eraser"===e)i.points=i.points.concat([o.x,o.y]);else{const[e,t]=i.points;i.points=[e,t,o.x,o.y]}s.splice(s.length-1,1,i),y(s.concat())},_=e=>{const t=e.split(";base64,"),s=t[0].split(":")[1],o=window.atob(t[1]),i=o.length,a=new Uint8Array(i);for(let n=0;n<i;++n)a[n]=o.charCodeAt(n);return new Blob([a],{type:s})};return(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{id:"tools",className:"grid grid-row-3 border p-4",children:[(0,k.jsx)("div",{id:"brash-tools",className:"pb-4",children:(0,k.jsxs)(n.A,{value:e,color:"primary",exclusive:!0,onChange:(e,s)=>{null!=s&&t(s)},"aria-label":"Brash Tools",children:[(0,k.jsx)(r.A,{value:"pen","aria-label":"pen",children:(0,k.jsx)(d.A,{})}),(0,k.jsx)(r.A,{value:"rect","aria-label":"rect",children:(0,k.jsx)(h.A,{})}),(0,k.jsx)(r.A,{value:"circle","aria-label":"circle",children:(0,k.jsx)(p.A,{})}),(0,k.jsx)(r.A,{value:"eraser","aria-label":"eraser",children:(0,k.jsx)(u.A,{className:"-rotate-45"})})]})}),(0,k.jsxs)("div",{id:"brash-setting",className:"flex flex-wrap gap-1 justify-around",children:[(0,k.jsx)("div",{className:"w-1/12",children:(0,k.jsx)("input",{type:"color",value:b,onChange:e=>C(e.target.value)})}),(0,k.jsxs)("div",{className:"w-5/12 grid grid-cols-12",children:[(0,k.jsx)(x.A,{}),(0,k.jsx)(l.Ay,{className:"col-span-11",min:1,max:10,value:N,onChange:(e,t)=>S(t)})]}),(0,k.jsxs)("div",{className:"w-5/12 grid grid-cols-12",children:[(0,k.jsx)(g.A,{}),(0,k.jsx)(l.Ay,{className:"col-span-11",min:.1,max:1,step:.1,value:W,onChange:(e,t)=>M(t)})]})]}),(0,k.jsxs)("div",{id:"action-tools",className:"flex flex-wrap gap-2",children:[(0,k.jsx)(c.A,{onClick:()=>{const e=[...P],t=e.pop();D([...B,s]),y(t||[]),I(e)},children:(0,k.jsx)(j.A,{})}),(0,k.jsx)(c.A,{onClick:()=>{if(0===B.length)return;const e=[...B],t=e.pop();I([...P,s]),y(t),D(e)},children:(0,k.jsx)(w.A,{})}),(0,k.jsx)(c.A,{onClick:()=>{y([]),I([]),D([])},children:(0,k.jsx)(v.A,{})}),(0,k.jsx)(c.A,{onClick:()=>{window.confirm("Do you wanna download your masterpiece?")&&F.current.toImage({callback(e){const t=e.src,s=_(t);(0,a.saveAs)(s,"drawing.png")}})},children:(0,k.jsx)(m.A,{})}),(0,k.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,k.jsx)("div",{children:"import background image..."}),(0,k.jsx)("input",{type:"file",onChange:e=>{var t;const s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s){const e=new FileReader;e.onload=function(e){var t;const s=new window.Image;s.src=null===(t=e.target)||void 0===t?void 0:t.result,s.onload=function(){R(s)}},e.readAsDataURL(s)}},className:"col-span-11"})]})]})]}),(0,k.jsx)(i.BI,{className:"border mt-4 hover:cursor-crosshair",width:window.innerWidth,height:window.innerHeight,onMouseMove:U,onMouseDown:T,onTouchStart:U,onTouchEnd:T,onMouseUp:()=>{A(!1),I([...P,s])},ref:F,children:(0,k.jsxs)(i.Wd,{children:[H&&(0,k.jsx)(i.rw,{x:0,y:0,width:window.innerWidth,height:window.innerHeight,fillPatternImage:H,fillPatternScale:{x:window.innerWidth/H.width,y:window.innerHeight/H.height}}),s.map(((e,t)=>((e,t)=>{switch(e.tool){case"pen":return(0,k.jsx)(i.N1,{points:e.points,stroke:e.strokeColor,strokeWidth:e.strokeWidth,opacity:e.opacity},t);case"eraser":return(0,k.jsx)(i.N1,{points:e.points,stroke:"#FFFFFF",strokeWidth:e.strokeWidth,opacity:e.opacity},t);case"rect":const[s,o,a,n]=e.points;return(0,k.jsx)(i.rw,{x:Math.min(s,a),y:Math.min(o,n),width:Math.abs(a-s),height:Math.abs(n-o),stroke:e.strokeColor,strokeWidth:e.strokeWidth,opacity:e.opacity},t);case"circle":const[r,l,c,d]=e.points,h=Math.hypot(c-r,d-l);return(0,k.jsx)(i.jl,{x:r,y:l,radius:h,stroke:e.strokeColor,strokeWidth:e.strokeWidth,opacity:e.opacity},t);default:return null}})(e,t)))]})})]})}}}]);
//# sourceMappingURL=258.c1918651.chunk.js.map